---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

1. Load the data (i.e. read.csv())

```{r}
data <- read.table("activity.csv", sep = ",", header = TRUE, na.strings = "NA")
```

2. Process/transform the data (if necessary) into a format suitable for your analysis

```{r}
library(data.table)
data$date <- as.Date(data$date, format = "%Y-%m-%d")
data <- data[complete.cases(data),]
data <- data.table(data)
summary(data)
```

## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day
```{r}
totalStepsPerDay <- data[,sum(steps),by=date]
```

2. Make a histogram of the total number of steps taken each day
```{r}
library(ggplot2)
ggplot(totalStepsPerDay, aes(x = V1)) +
  geom_histogram(stat="bin", binwidth=4000) +
  xlab("Total steps for each day")
```

3. Calculate and report the mean and median of the total number of steps taken per day
```{r}
mean(totalStepsPerDay$V1)
median(totalStepsPerDay$V1)
```


## What is the average daily activity pattern?

1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r}
avgStepsPerInterval <- data[,mean(steps),by=interval]

ggplot(avgStepsPerInterval, aes(x = interval, y = V1)) +
  geom_line() +
  xlab("Interval") +
  ylab("Average number of steps for each day")
```

2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
avgStepsPerInterval[which.max(avgStepsPerInterval$V1)]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
